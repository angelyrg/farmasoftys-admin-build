import{r,j as e}from"./index-KRR1voBs.js";import{a as S,e as h}from"./endpoints-BRXFbWk7.js";import{a as y,c as b}from"./index.esm-2SyroXAh.js";import{R as B}from"./react-paginate-CyfXF6zb.js";import{M as U}from"./ModalConfirmaciónEliminación-Df14SXDI.js";import{h as O}from"./categoryUtils-BdmLsdnX.js";import{C as $,a as z,b as F,c as H,d as q}from"./CModalTitle-BgxwinQn.js";import{C as G}from"./CForm-CqHMos8T.js";import{C as R,a as c}from"./CRow-Dfp_45qR.js";import{C as o}from"./CFormInput-C1jpBkWS.js";import{C as J,a as K}from"./CCardBody-Wh3Akqox.js";import{C as Q}from"./CCardHeader-BJ0TBwBd.js";import{C as V,a as W,b as P,c as d,d as X,e as m}from"./CTable-ftmU2Ut3.js";import{I as Y}from"./DefaultLayout-ChcLXGeV.js";import{c as Z,a as ee}from"./cil-trash-prAk5aip.js";import{a as ae,c as le}from"./cil-chevron-right-DSvcss7_.js";import"./CFormControlWrapper-C8GjXxBu.js";import"./CFormControlValidation-E3-qERzG.js";import"./CFormLabel-DWnF6Muz.js";import"./cil-user-Dlmw-Gem.js";import"./softys-8HeVkQ7R.js";const ne=({visible:g,onClose:x,onSave:j,store:a})=>{const[i,C]=r.useState({id:(a==null?void 0:a.id)||"",name:(a==null?void 0:a.name)||"",ruc:(a==null?void 0:a.ruc)||"",address:(a==null?void 0:a.address)||"",latitude:(a==null?void 0:a.latitude)||"",longitude:(a==null?void 0:a.longitude)||"",phone:(a==null?void 0:a.phone)||"",max_radius:(a==null?void 0:a.max_radius)||"",tienda_img:null}),n=t=>{const{name:E,value:v,files:p}=t.target;C({...i,[E]:p?p[0]:v})},s=async()=>{try{await O(i,j,"tienda_img")}catch(t){console.error("Error al enviar el formulario:",t)}};return r.useEffect(()=>{C({id:(a==null?void 0:a.id)||"",name:(a==null?void 0:a.name)||"",ruc:(a==null?void 0:a.ruc)||"",address:(a==null?void 0:a.address)||"",latitude:(a==null?void 0:a.latitude)||"",longitude:(a==null?void 0:a.longitude)||"",phone:(a==null?void 0:a.phone)||"",max_radius:(a==null?void 0:a.max_radius)||"",tienda_img:(a==null?void 0:a.tienda_img)||null})},[a]),e.jsxs($,{visible:g,onClose:x,size:"lg",children:[e.jsx(z,{children:e.jsx(F,{children:"Editar Tienda"})}),e.jsx(H,{children:e.jsx(G,{children:e.jsxs(R,{children:[e.jsx(c,{md:6,children:e.jsx(o,{type:"text",label:"Nombre",name:"name",value:i.name,onChange:n,placeholder:"Nombre de la tienda",autoComplete:"off",required:!0})}),e.jsx(c,{md:6,children:e.jsx(o,{type:"text",label:"RUC",name:"ruc",autoComplete:"off",value:i.ruc,onChange:n,maxLength:20,required:!0})}),e.jsx(c,{md:6,children:e.jsx(o,{type:"text",label:"Dirección",name:"address",autoComplete:"off",value:i.address,onChange:n,maxLength:20,required:!0})}),e.jsx(c,{md:6,children:e.jsx(o,{type:"text",label:"Teléfono",name:"phone",autoComplete:"off",value:i.phone,onChange:n})}),e.jsx(c,{md:2,sm:6,children:e.jsx(o,{type:"number",label:"Latitud",name:"latitude",autoComplete:"off",value:i.latitude,onChange:n,placeholder:"-12.04318",step:"any",min:"-90",max:"90"})}),e.jsx(c,{md:2,sm:6,children:e.jsx(o,{type:"number",label:"Longitud",name:"longitude",autoComplete:"off",value:i.longitude,onChange:n,placeholder:"-77.02824",step:"any",min:"-180",max:"180"})}),e.jsx(c,{md:2,sm:6,children:e.jsx(o,{type:"number",label:"Radio máximo",name:"max_radius",autoComplete:"off",value:i.max_radius,onChange:n,step:"any",min:"0",max:"180"})}),e.jsx(c,{md:6,children:e.jsx(o,{type:"file",label:"Imagen",name:"tienda_img",onChange:n,accept:"image/*"})})]})})}),e.jsxs(q,{children:[e.jsx(y,{color:"secondary",onClick:x,children:"Cancelar"}),e.jsx(y,{color:"primary",onClick:s,children:"Guardar"})]})]})},Ne=()=>{const g=`${h.API_BASE_URL}${h.ENDPOINTS.STORES.GET}`,[x,j]=r.useState([]),[a,i]=r.useState(!0),[C,n]=r.useState(null),[s,t]=r.useState({visible:!1,type:null,store:null}),[E,v]=r.useState(0),p=5,N=E*p,I=x.slice(N,N+p),T=Math.ceil(x.length/p),D=l=>{v(l.selected)},L=r.useCallback(async()=>{try{const l=await S.get(g);l.data.success?j(l.data.data):n(l.data.message)}catch{n("Error al obtener los datos")}finally{i(!1)}},[g]);r.useEffect(()=>{L()},[]);const M=async()=>{if(s.store)try{const l=`${h.API_BASE_URL}${h.ENDPOINTS.STORES.DELETE(s.store.id)}`,u=await S.delete(l);u.data.success?j(f=>f.filter(A=>A.id!==s.store.id)):n(u.data.message)}catch{n("Error al eliminar la tienda")}finally{t({visible:!1,type:null,store:null})}},w=async l=>{try{const u=`${h.API_BASE_URL}${h.ENDPOINTS.STORES.UPDATE(l.id)}`,f=await S.put(u,l);f.data.success?L():n(f.data.message)}catch{n("Error al actualizar la categoría")}finally{t({visible:!1,type:null,store:null})}},_=(l,u=null)=>{t({visible:!0,type:l,store:u})},k=()=>{t({visible:!1,type:null,store:null})};return a?e.jsx("p",{children:"Cargando..."}):C?e.jsxs("p",{children:["Error: ",C]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{children:e.jsx(c,{xs:12,children:e.jsxs(J,{className:"mb-4",children:[e.jsxs(Q,{children:[e.jsx("strong",{children:"Tiendas"})," ",e.jsx("small",{children:"Listar"})]}),e.jsxs(K,{children:[e.jsxs(V,{striped:!0,responsive:!0,children:[e.jsx(W,{children:e.jsxs(P,{children:[e.jsx(d,{scope:"col",children:"ID"}),e.jsx(d,{scope:"col",children:"Nombre"}),e.jsx(d,{scope:"col",children:"RUC"}),e.jsx(d,{scope:"col",children:"Dirección"}),e.jsx(d,{scope:"col",children:"Coordenadas"}),e.jsx(d,{scope:"col",children:"Rango"}),e.jsx(d,{scope:"col",children:"Celular"}),e.jsx(d,{scope:"col",children:"Imagen"}),e.jsx(d,{scope:"col",children:"Acción"})]})}),e.jsx(X,{children:I.map(l=>e.jsxs(P,{children:[e.jsx(d,{scope:"row",children:l.id}),e.jsx(m,{children:l.name}),e.jsx(m,{children:l.ruc}),e.jsx(m,{children:l.address}),e.jsxs(m,{children:[l.latitude,", ",l.longitude]}),e.jsx(m,{children:l.max_radius}),e.jsx(m,{children:l.phone}),e.jsx(m,{children:e.jsx(Y,{rounded:!0,thumbnail:!0,src:l.tienda_img,width:50,height:50})}),e.jsxs(m,{children:[e.jsx(y,{color:"warning",size:"sm",className:"me-2",onClick:()=>_("edit",l),children:e.jsx(b,{icon:Z})}),e.jsx(y,{color:"danger",size:"sm",onClick:()=>_("delete",l),children:e.jsx(b,{icon:ee})})]})]},l.id))})]}),T>1&&e.jsx(B,{previousLabel:e.jsx(b,{icon:le}),nextLabel:e.jsx(b,{icon:ae}),breakLabel:"...",breakClassName:"page-item",breakLinkClassName:"page-link",pageCount:T,marginPagesDisplayed:2,pageRangeDisplayed:5,onPageChange:D,containerClassName:"pagination justify-content-center",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",activeClassName:"active",disabledClassName:"disabled"})]})]})})}),s.type==="delete"&&e.jsx(U,{visible:s.visible,onClose:k,onConfirm:M}),s.type==="edit"&&e.jsx(ne,{visible:s.visible,onClose:k,onSave:w,store:s.store})]})};export{Ne as default};
