import{r as l,j as e}from"./index-BbdSqWC9.js";import{a as E,e as c}from"./endpoints-BX9h9ZCO.js";import{a as f,c as g}from"./index.esm-DCg1vWKa.js";import{R as A}from"./react-paginate-DCkc9IEO.js";import{M as w}from"./ModalConfirmaciónEliminación-CmWqohBo.js";import{h as B}from"./categoryUtils-ReMHyvb-.js";import{C as O,a as $,b as G,c as U}from"./CModalHeader-C_EbAsF2.js";import{C as F}from"./CModalTitle-7K0FyB5J.js";import{C as H}from"./CForm-BsUL6XdD.js";import{C as T}from"./CFormInput-DDUSGyiz.js";import{C as z,a as Y}from"./CRow-DX7WfHcK.js";import{C as q,a as J}from"./CCardBody-B-X9cGRP.js";import{C as K}from"./CCardHeader-DLbDbJrL.js";import{C as Q,a as V,b as I,c as C,d as W,e as v}from"./CTable-xzfvi4v6.js";import{I as X}from"./DefaultLayout-BuKkoChH.js";import{c as Z,a as ee}from"./cil-trash-prAk5aip.js";import{a as se,c as ae}from"./cil-chevron-right-DSvcss7_.js";import"./CFormControlWrapper-CSgDey9a.js";import"./CFormControlValidation-La-DNwq6.js";import"./CFormLabel-Bi_OkBaw.js";import"./cil-user-Dlmw-Gem.js";import"./softys-8HeVkQ7R.js";const re=({visible:h,onClose:d,onSave:u,categoria:a})=>{const[m,p]=l.useState({id:(a==null?void 0:a.id)||"",description:(a==null?void 0:a.description)||"",category_image:null}),t=n=>{const{name:j,value:y,files:o}=n.target;p({...m,[j]:o?o[0]:y})},r=async()=>{try{await B(m,u,"category_image")}catch(n){console.error("Error al enviar el formulario:",n)}};return l.useEffect(()=>{p({id:(a==null?void 0:a.id)||"",description:(a==null?void 0:a.description)||"",category_image:(a==null?void 0:a.category_image)||null})},[a]),e.jsxs(O,{visible:h,onClose:d,children:[e.jsx($,{children:e.jsx(F,{children:"Editar Categoría"})}),e.jsx(G,{children:e.jsxs(H,{children:[e.jsx(T,{type:"text",label:"Descripción",name:"description",value:m.description,onChange:t,required:!0}),e.jsx(T,{type:"file",label:"Imagen",name:"category_image",onChange:t})]})}),e.jsxs(U,{children:[e.jsx(f,{color:"secondary",onClick:d,children:"Cancelar"}),e.jsx(f,{color:"primary",onClick:r,children:"Guardar"})]})]})},ke=()=>{const h=`${c.API_BASE_URL}${c.ENDPOINTS.CATEGORY.GET}`,[d,u]=l.useState([]),[a,m]=l.useState(!0),[p,t]=l.useState(null),[r,n]=l.useState({visible:!1,type:null,category:null}),[j,y]=l.useState(0),o=5,N=j*o,L=d.slice(N,N+o),S=Math.ceil(d.length/o),D=s=>{y(s.selected)},b=l.useCallback(async()=>{try{const s=await E.get(h);s.data.success?u(s.data.data):t(s.data.message)}catch{t("Error al obtener los datos")}finally{m(!1)}},[h]);l.useEffect(()=>{b()},[b]);const R=async()=>{if(r.category)try{const s=`${c.API_BASE_URL}${c.ENDPOINTS.CATEGORY.DELETE(r.category.id)}`,i=await E.delete(s);i.data.success?u(x=>x.filter(_=>_.id!==r.category.id)):t(i.data.message)}catch{t("Error al eliminar la categoría")}finally{n({visible:!1,type:null,category:null})}},M=async s=>{try{const i=`${c.API_BASE_URL}${c.ENDPOINTS.CATEGORY.UPDATE(s.id)}`,x=await E.put(i,s);x.data.success?b():t(x.data.message)}catch{t("Error al actualizar la categoría")}finally{n({visible:!1,type:null,category:null})}},k=(s,i=null)=>{n({visible:!0,type:s,category:i})},P=()=>{n({visible:!1,type:null,category:null})};return a?e.jsx("p",{children:"Cargando..."}):p?e.jsxs("p",{children:["Error: ",p]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{children:e.jsx(Y,{xs:12,children:e.jsxs(q,{className:"mb-4",children:[e.jsxs(K,{children:[e.jsx("strong",{children:"Categorías"})," ",e.jsx("small",{children:"Listar"})]}),e.jsxs(J,{children:[e.jsxs(Q,{striped:!0,responsive:!0,children:[e.jsx(V,{children:e.jsxs(I,{children:[e.jsx(C,{scope:"col",children:"#"}),e.jsx(C,{scope:"col",children:"Descripción"}),e.jsx(C,{scope:"col",children:"Imagen"}),e.jsx(C,{scope:"col",children:"Opciones"})]})}),e.jsx(W,{children:L.map(s=>e.jsxs(I,{children:[e.jsx(C,{scope:"row",children:s.id}),e.jsx(v,{children:s.description}),e.jsx(v,{children:e.jsx(X,{rounded:!0,thumbnail:!0,src:s.category_image,width:50,height:50})}),e.jsxs(v,{children:[e.jsx(f,{color:"warning",size:"sm",className:"me-2",onClick:()=>k("edit",s),children:e.jsx(g,{icon:Z})}),e.jsx(f,{color:"danger",size:"sm",onClick:()=>k("delete",s),children:e.jsx(g,{icon:ee})})]})]},s.id))})]}),S>1&&e.jsx(A,{previousLabel:e.jsx(g,{icon:ae}),nextLabel:e.jsx(g,{icon:se}),breakLabel:"...",breakClassName:"page-item",breakLinkClassName:"page-link",pageCount:S,marginPagesDisplayed:2,pageRangeDisplayed:5,onPageChange:D,containerClassName:"pagination justify-content-center",pageClassName:"page-item",pageLinkClassName:"page-link",previousClassName:"page-item",previousLinkClassName:"page-link",nextClassName:"page-item",nextLinkClassName:"page-link",activeClassName:"active",disabledClassName:"disabled"})]})]})})}),r.type==="delete"&&e.jsx(w,{visible:r.visible,onClose:P,onConfirm:R}),r.type==="edit"&&e.jsx(re,{visible:r.visible,onClose:P,onSave:M,categoria:r.category})]})};export{ke as default};
